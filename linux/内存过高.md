# Linux 内存过高解决思路

## 查看内存使用情况
```
free -m

cat /proc/meminfo
```

## atop 按 m 统计内存使用情况
```
MEM |  tot     7.8G |  free    6.6G |  cache 402.0M  | dirty   0.3M  | buff   53.1M  |  slab  132.6M |
```

##


## slap 占用内存过高



```
回收dentry cache和inode cache占用的内存
#echo 2 > /proc/sys/vm/drop_caches
等内存回收完毕后再恢复:
#echo 0 > /proc/sys/vm/drop_caches

To free pagecache:
	echo 1 > /proc/sys/vm/drop_caches
To free reclaimable slab objects (includes dentries and inodes):
	echo 2 > /proc/sys/vm/drop_caches
To free slab objects and pagecache:
	echo 3 > /proc/sys/vm/drop_caches
```

## slabtop 查看slab情况

## 目前来看是 过高的slab内存无法回收导致内存不足

可以提高slab内存释放的优先级,vfs_cache_pressure的设置并不会在系统中马上体现出来, dentry 和inode cache会有一个到高峰后突然下降,然后逐渐正常波动的过程. 因此需要运行个24小时
```
echo 10000 > /proc/sys/vm/vfs_cache_pressure
```


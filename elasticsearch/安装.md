---
Title: elasticsearch在centos下的安装步骤
Keywords: elasticsearch安装步骤,中文分词,ik
Description: 记录一下elasticsearch安装步骤，方便以后有个思路
Author: douyacun
Cover: 
Label: elasticsearch安装
Date: 2019-10-11 13:04:30
LastEditTime: 2019-10-11 22:57:11
---

[TOC]

# elasticsearch 安装

## 下载和安装步骤



[官方文档](https://www.elastic.co/cn/downloads/elasticsearch)给出的安装步骤是比较详细的 

1. 下载压缩文件
2. Linux运行 bin/elasticsearch Windows运行bin\elasticsearch.bat
3. curl http://localhost:9200/

## 文件描述符限制
`/etc/security/limits.conf`

```conf
*               soft    nofile          65536
*               hard    nofile          65536
*               soft    nproc           4096
*               hard    nproc           4096
```
## 启动内存不足
```
Java HotSpot(TM) 64-Bit Server VM warning: INFO: os::commit_memory(0x0000000085330000, 2060255232, 0) failed; error='Cannot allocate memory' (errno=12)
#
# There is insufficient memory for the Java Runtime Environment to continue.
# Native memory allocation (mmap) failed to map 2060255232 bytes for committing reserved memory.
# An error report file with more information is saved as:
# /data/elasticsearch-5.2.2/hs_err_pid26945.log
```
vim config/jvm.options

-Xms/-Xmx 设置成同等大小

-Xmx 不要超过内存的50%，不要超过30G

## 不能以root启动
这个就新增一个用户
```
useradd www
sudo su www
./elasticsearch/bin/elasticsearch
```

# 插件安装

安装一个中文智能分词插件 [Smart Chinese Analysis plugin](https://www.elastic.co/guide/en/elasticsearch/plugins/current/analysis-smartcn.html#analysis-smartcn)

```shell
➜  elasticsearch-7.5.0 bin/elasticsearch-plugin install analysis-smartcn
-> Downloading analysis-smartcn from elastic
[=================================================] 100%
-> Installed analysis-smartcn
➜  elasticsearch-7.5.0 bin/elasticsearch-plugin list
analysis-smartcn
```

# 多实例运行

```shell
bin/elasticsearch -E node.name=n1 -E cluster.name=douyacun -E path.data=n1_data -d
bin/elasticsearch -E node.name=n2 -E cluster.name=douyacun -E path.data=n2_data -d
bin/elasticsearch -E node.name=n3 -E cluster.name=douyacun -E path.data=n3_data -d
```

查看当前运行实例的情况	

```shell
➜  elasticsearch-7.5.0 curl -X GET http://127.0.0.1:9200/_cat/nodes
127.0.0.1 13 91 7 2.61   dilm - n2
127.0.0.1 16 91 7 2.61   dilm - n3
127.0.0.1 28 91 7 2.61   dilm * n1
```

关闭已经运行的实例

```shell
ps|grep elastic|awk '{print  $1}'|xargs kill
```


---
Title: "go prometheus metrics grafana监控配置"
Description: "go进程metric grafana json model"
---

变量:

- instance: 机器实例
- job: 项目

```json
{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"description":"Golang Application Runtime metrics","editable":true,"gnetId":10826,"graphTooltip":0,"id":2,"iteration":1618371883418,"links":[],"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":0},"hiddenSeries":false,"id":26,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"go_memstats_mspan_inuse_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_mspan_inuse_bytes","refId":"A"},{"exemplar":true,"expr":"go_memstats_mspan_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_mspan_sys_bytes","refId":"B"},{"exemplar":true,"expr":"go_memstats_mcache_inuse_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_mcache_inuse_bytes","refId":"C"},{"exemplar":true,"expr":"go_memstats_mcache_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_mcache_sys_bytes","refId":"D"},{"exemplar":true,"expr":"go_memstats_buck_hash_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_buck_hash_sys_bytes","refId":"E"},{"exemplar":true,"expr":"go_memstats_gc_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_gc_sys_bytes","refId":"F"},{"exemplar":true,"expr":"go_memstats_other_sys_bytes{instance=\"$instance\", job=\"$job\"} - go_memstats_other_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"bytes of memory are used for other runtime allocations ","refId":"G"},{"exemplar":true,"expr":"go_memstats_next_gc_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_next_gc_bytes","refId":"H"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory in Off-Heap","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":0},"hiddenSeries":false,"id":12,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"go_memstats_heap_alloc_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_heap_alloc_bytes","refId":"B"},{"exemplar":true,"expr":"go_memstats_heap_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_heap_sys_bytes","refId":"A"},{"exemplar":true,"expr":"go_memstats_heap_idle_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_heap_idle_bytes","refId":"C"},{"exemplar":true,"expr":"go_memstats_heap_inuse_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_heap_inuse_bytes","refId":"D"},{"exemplar":true,"expr":"go_memstats_heap_released_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_heap_released_bytes","refId":"E"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory in Heap","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":8},"hiddenSeries":false,"id":24,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"go_memstats_stack_inuse_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_stack_inuse_bytes","refId":"A"},{"exemplar":true,"expr":"go_memstats_stack_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_stack_sys_bytes","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory in Stack","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":8},"hiddenSeries":false,"id":16,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"go_memstats_sys_bytes{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_sys_bytes","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total Used Memory","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":16},"hiddenSeries":false,"id":22,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"go_memstats_mallocs_total{instance=\"$instance\", job=\"$job\"} - go_memstats_frees_total{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"Number of Live Objects","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Number of Live Objects","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"shows how many heap objects are allocated. This is a counter value so you can use rate() to objects allocated/s.","fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":16},"hiddenSeries":false,"id":20,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"rate(go_memstats_mallocs_total{instance=\"$instance\", job=\"$job\"}[1m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_mallocs_total","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Rate of Objects Allocated","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"go_memstats_lookups_total – counts how many pointer dereferences happened. This is a counter value so you can use rate() to lookups/s.","fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":24},"hiddenSeries":false,"id":18,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"rate(go_memstats_lookups_total{instance=\"$instance\", job=\"$job\"}[1m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_lookups_total","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Rate of a Pointer Dereferences","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":24},"hiddenSeries":false,"id":8,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"go_goroutines{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_goroutines","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Goroutines","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":32},"hiddenSeries":false,"id":14,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":1,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"rate(go_memstats_alloc_bytes_total{instance=\"$instance\", job=\"$job\"}[1m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_memstats_alloc_bytes_total","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Rates of Allocation","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":32},"hiddenSeries":false,"id":4,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.5.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"exemplar":true,"expr":"go_gc_duration_seconds{instance=\"$instance\", job=\"$job\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"go_gc_duration_seconds-{{quantile}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"GC duration quantile","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"30s","schemaVersion":27,"style":"dark","tags":["go","tea"],"templating":{"list":[{"allValue":null,"current":{"selected":false,"text":"139.198.178.38:9003","value":"139.198.178.38:9003"},"datasource":"Prometheus","definition":"label_values(go_goroutines{job=\"tea\"},instance)","description":null,"error":null,"hide":0,"includeAll":false,"label":"instance","multi":false,"name":"instance","options":[],"query":{"query":"label_values(go_goroutines{job=\"tea\"},instance)","refId":"StandardVariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":true,"text":"tea","value":"tea"},"datasource":null,"definition":"label_values(go_goroutines{job=\"tea\"},job)","description":null,"error":null,"hide":0,"includeAll":false,"label":"job","multi":false,"name":"job","options":[{"selected":true,"text":"tea","value":"tea"}],"query":{"query":"label_values(go_goroutines{job=\"tea\"},job)","refId":"StandardVariableQuery"},"refresh":0,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"hidden":false,"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Tea Metrics","uid":"CgCw8jKZz","version":17}
```




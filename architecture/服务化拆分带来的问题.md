---
Title: 代表我能力的经历
Keywords: 
Description: 
Cover: 
Label: 
Date: 2020-05-10 20:24:58
LastEditTime: 2020-05-10 20:24:58
---

在将dsp平台服务化拆分时，将创意、物料审核相关的业务迁移到了运营平台，

面临的问题：

1. 创意审核版本问题
2. adv创意、物料创建是调用运营接口来通知到的，运营平台出现了几次请求超时的问题导致adv创建创意也超时了
3. 日志问题： 就是排查上面问题时，第一次出现问题都没有日志无处排查，之后才设置超时时间、写的日志。
4. 运营审核通过调用adv接口没有成功，但是运营侧审核结果还是通过了。
5. 表结构变更失败，表结构变更获取不到M锁

解决方案:

1. 第一个问题 是使用mysql乐观锁，创意表增加一个version字段，每次变更version+1
2. 第二个问题 adv调用运营接口超时问题，目标是解耦adv和运营，方案是异步处理，可靠消息队列，当时比对了redis、RoketMQ、kafak，最终选择了RoketMQ
3. 第三个问题 日志没有记录、或者记录不全 方案采用 接入opentracing日志，用的uber开源的jaeger
4. 第四个问题 运营和adv审核数据不一致的情况，方案是 接入RoketMq，同时增加一个topic告诉运营哪些审核数据adv处理失败了需要再次审核
5. 因为creative表是热表，一直没有获取到